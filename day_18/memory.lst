     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_load_eflags
     7 00000000                                 	EXTERN	_io_store_eflags
     8 00000000                                 	EXTERN	_memtest_sub
     9 00000000                                 	EXTERN	_load_cr0
    10 00000000                                 	EXTERN	_store_cr0
    11 00000000                                 [FILE "memory.c"]
    12                                          [SECTION .text]
    13 00000000                                 	GLOBAL	_memtest
    14 00000000                                 _memtest:
    15 00000000 55                              	PUSH	EBP
    16 00000001 89 E5                           	MOV	EBP,ESP
    17 00000003 56                              	PUSH	ESI
    18 00000004 53                              	PUSH	EBX
    19 00000005 31 F6                           	XOR	ESI,ESI
    20 00000007 E8 [00000000]                   	CALL	_io_load_eflags
    21 0000000C 0D 00040000                     	OR	EAX,262144
    22 00000011 50                              	PUSH	EAX
    23 00000012 E8 [00000000]                   	CALL	_io_store_eflags
    24 00000017 E8 [00000000]                   	CALL	_io_load_eflags
    25 0000001C 5A                              	POP	EDX
    26 0000001D A9 00040000                     	TEST	EAX,262144
    27 00000022 74 05                           	JE	L2
    28 00000024 BE 00000001                     	MOV	ESI,1
    29 00000029                                 L2:
    30 00000029 25 FFFBFFFF                     	AND	EAX,-262145
    31 0000002E 50                              	PUSH	EAX
    32 0000002F E8 [00000000]                   	CALL	_io_store_eflags
    33 00000034 58                              	POP	EAX
    34 00000035 89 F0                           	MOV	EAX,ESI
    35 00000037 84 C0                           	TEST	AL,AL
    36 00000039 75 31                           	JNE	L5
    37 0000003B                                 L3:
    38 0000003B FF 75 0C                        	PUSH	DWORD [12+EBP]
    39 0000003E FF 75 08                        	PUSH	DWORD [8+EBP]
    40 00000041 E8 [00000000]                   	CALL	_memtest_sub
    41 00000046 5A                              	POP	EDX
    42 00000047 89 C3                           	MOV	EBX,EAX
    43 00000049 59                              	POP	ECX
    44 0000004A 89 F0                           	MOV	EAX,ESI
    45 0000004C 84 C0                           	TEST	AL,AL
    46 0000004E 75 09                           	JNE	L6
    47 00000050                                 L4:
    48 00000050 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    49 00000053 89 D8                           	MOV	EAX,EBX
    50 00000055 5B                              	POP	EBX
    51 00000056 5E                              	POP	ESI
    52 00000057 5D                              	POP	EBP
    53 00000058 C3                              	RET
    54 00000059                                 L6:
    55 00000059 E8 [00000000]                   	CALL	_load_cr0
    56 0000005E 25 9FFFFFFF                     	AND	EAX,-1610612737
    57 00000063 50                              	PUSH	EAX
    58 00000064 E8 [00000000]                   	CALL	_store_cr0
    59 00000069 58                              	POP	EAX
    60 0000006A EB E4                           	JMP	L4
    61 0000006C                                 L5:
    62 0000006C E8 [00000000]                   	CALL	_load_cr0
    63 00000071 0D 60000000                     	OR	EAX,1610612736
    64 00000076 50                              	PUSH	EAX
    65 00000077 E8 [00000000]                   	CALL	_store_cr0
    66 0000007C 5B                              	POP	EBX
    67 0000007D EB BC                           	JMP	L3
    68 0000007F                                 	GLOBAL	_memtest_sub_temp
    69 0000007F                                 _memtest_sub_temp:
    70 0000007F 55                              	PUSH	EBP
    71 00000080 89 E5                           	MOV	EBP,ESP
    72 00000082 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
    73 00000085 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    74 00000088 39 D0                           	CMP	EAX,EDX
    75 0000008A 77 09                           	JA	L9
    76 0000008C                                 L15:
    77 0000008C                                 L13:
    78 0000008C 05 00001000                     	ADD	EAX,4096
    79 00000091 39 D0                           	CMP	EAX,EDX
    80 00000093 76 F7                           	JBE	L15
    81 00000095                                 L9:
    82 00000095 5D                              	POP	EBP
    83 00000096 C3                              	RET
    84 00000097                                 	GLOBAL	_memman_init
    85 00000097                                 _memman_init:
    86 00000097 55                              	PUSH	EBP
    87 00000098 89 E5                           	MOV	EBP,ESP
    88 0000009A 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    89 0000009D C7 00 00000000                  	MOV	DWORD [EAX],0
    90 000000A3 C7 40 04 00000000               	MOV	DWORD [4+EAX],0
    91 000000AA C7 40 08 00000000               	MOV	DWORD [8+EAX],0
    92 000000B1 C7 40 0C 00000000               	MOV	DWORD [12+EAX],0
    93 000000B8 5D                              	POP	EBP
    94 000000B9 C3                              	RET
    95 000000BA                                 	GLOBAL	_memman_total
    96 000000BA                                 _memman_total:
    97 000000BA 55                              	PUSH	EBP
    98 000000BB 31 C0                           	XOR	EAX,EAX
    99 000000BD 89 E5                           	MOV	EBP,ESP
   100 000000BF 31 D2                           	XOR	EDX,EDX
   101 000000C1 53                              	PUSH	EBX
   102 000000C2 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   103 000000C5 8B 0B                           	MOV	ECX,DWORD [EBX]
   104 000000C7 39 C8                           	CMP	EAX,ECX
   105 000000C9 73 09                           	JAE	L25
   106 000000CB                                 L23:
   107 000000CB 03 44 D3 14                     	ADD	EAX,DWORD [20+EBX+EDX*8]
   108 000000CF 42                              	INC	EDX
   109 000000D0 39 CA                           	CMP	EDX,ECX
   110 000000D2 72 F7                           	JB	L23
   111 000000D4                                 L25:
   112 000000D4 5B                              	POP	EBX
   113 000000D5 5D                              	POP	EBP
   114 000000D6 C3                              	RET
   115 000000D7                                 	GLOBAL	_memman_alloc
   116 000000D7                                 _memman_alloc:
   117 000000D7 55                              	PUSH	EBP
   118 000000D8 31 C9                           	XOR	ECX,ECX
   119 000000DA 89 E5                           	MOV	EBP,ESP
   120 000000DC 57                              	PUSH	EDI
   121 000000DD 56                              	PUSH	ESI
   122 000000DE 53                              	PUSH	EBX
   123 000000DF 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   124 000000E2 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   125 000000E5 8B 03                           	MOV	EAX,DWORD [EBX]
   126 000000E7 39 C1                           	CMP	ECX,EAX
   127 000000E9 73 0D                           	JAE	L40
   128 000000EB                                 L38:
   129 000000EB 8B 54 CB 14                     	MOV	EDX,DWORD [20+EBX+ECX*8]
   130 000000EF 39 F2                           	CMP	EDX,ESI
   131 000000F1 73 0C                           	JAE	L42
   132 000000F3 41                              	INC	ECX
   133 000000F4 39 C1                           	CMP	ECX,EAX
   134 000000F6 72 F3                           	JB	L38
   135 000000F8                                 L40:
   136 000000F8 31 C0                           	XOR	EAX,EAX
   137 000000FA                                 L26:
   138 000000FA 5B                              	POP	EBX
   139 000000FB 5E                              	POP	ESI
   140 000000FC 5F                              	POP	EDI
   141 000000FD 5D                              	POP	EBP
   142 000000FE C3                              	RET
   143 000000FF                                 L42:
   144 000000FF 8B 7C CB 10                     	MOV	EDI,DWORD [16+EBX+ECX*8]
   145 00000103 8D 04 3E                        	LEA	EAX,DWORD [ESI+EDI*1]
   146 00000106 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
   147 0000010A 89 D0                           	MOV	EAX,EDX
   148 0000010C 29 F0                           	SUB	EAX,ESI
   149 0000010E 89 44 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EAX
   150 00000112 85 C0                           	TEST	EAX,EAX
   151 00000114 75 20                           	JNE	L32
   152 00000116 8B 03                           	MOV	EAX,DWORD [EBX]
   153 00000118 48                              	DEC	EAX
   154 00000119 89 03                           	MOV	DWORD [EBX],EAX
   155 0000011B 39 C1                           	CMP	ECX,EAX
   156 0000011D 73 17                           	JAE	L32
   157 0000011F 89 C6                           	MOV	ESI,EAX
   158 00000121                                 L37:
   159 00000121 8B 44 CB 18                     	MOV	EAX,DWORD [24+EBX+ECX*8]
   160 00000125 8B 54 CB 1C                     	MOV	EDX,DWORD [28+EBX+ECX*8]
   161 00000129 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
   162 0000012D 89 54 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EDX
   163 00000131 41                              	INC	ECX
   164 00000132 39 F1                           	CMP	ECX,ESI
   165 00000134 72 EB                           	JB	L37
   166 00000136                                 L32:
   167 00000136 89 F8                           	MOV	EAX,EDI
   168 00000138 EB C0                           	JMP	L26
   169 0000013A                                 	GLOBAL	_memman_free
   170 0000013A                                 _memman_free:
   171 0000013A 55                              	PUSH	EBP
   172 0000013B 89 E5                           	MOV	EBP,ESP
   173 0000013D 57                              	PUSH	EDI
   174 0000013E 56                              	PUSH	ESI
   175 0000013F 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   176 00000142 53                              	PUSH	EBX
   177 00000143 31 DB                           	XOR	EBX,EBX
   178 00000145 8B 3E                           	MOV	EDI,DWORD [ESI]
   179 00000147 39 FB                           	CMP	EBX,EDI
   180 00000149 7D 0E                           	JGE	L45
   181 0000014B                                 L49:
   182 0000014B 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   183 0000014E 39 44 DE 10                     	CMP	DWORD [16+ESI+EBX*8],EAX
   184 00000152 77 05                           	JA	L45
   185 00000154 43                              	INC	EBX
   186 00000155 39 FB                           	CMP	EBX,EDI
   187 00000157 7C F2                           	JL	L49
   188 00000159                                 L45:
   189 00000159 85 DB                           	TEST	EBX,EBX
   190 0000015B 7E 0F                           	JLE	L50
   191 0000015D 8B 54 DE 0C                     	MOV	EDX,DWORD [12+ESI+EBX*8]
   192 00000161 8B 44 DE 08                     	MOV	EAX,DWORD [8+ESI+EBX*8]
   193 00000165 01 D0                           	ADD	EAX,EDX
   194 00000167 3B 45 0C                        	CMP	EAX,DWORD [12+EBP]
   195 0000016A 74 73                           	JE	L73
   196 0000016C                                 L50:
   197 0000016C 39 FB                           	CMP	EBX,EDI
   198 0000016E 7D 0C                           	JGE	L59
   199 00000170 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   200 00000173 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   201 00000176 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   202 0000017A 74 53                           	JE	L74
   203 0000017C                                 L59:
   204 0000017C 81 FF 00000FF9                  	CMP	EDI,4089
   205 00000182 7F 3D                           	JG	L61
   206 00000184 89 F9                           	MOV	ECX,EDI
   207 00000186 39 DF                           	CMP	EDI,EBX
   208 00000188 7E 15                           	JLE	L71
   209 0000018A                                 L66:
   210 0000018A 8B 44 CE 08                     	MOV	EAX,DWORD [8+ESI+ECX*8]
   211 0000018E 8B 54 CE 0C                     	MOV	EDX,DWORD [12+ESI+ECX*8]
   212 00000192 89 44 CE 10                     	MOV	DWORD [16+ESI+ECX*8],EAX
   213 00000196 89 54 CE 14                     	MOV	DWORD [20+ESI+ECX*8],EDX
   214 0000019A 49                              	DEC	ECX
   215 0000019B 39 D9                           	CMP	ECX,EBX
   216 0000019D 7F EB                           	JG	L66
   217 0000019F                                 L71:
   218 0000019F 8D 47 01                        	LEA	EAX,DWORD [1+EDI]
   219 000001A2 89 06                           	MOV	DWORD [ESI],EAX
   220 000001A4 39 46 04                        	CMP	DWORD [4+ESI],EAX
   221 000001A7 7D 03                           	JGE	L67
   222 000001A9 89 46 04                        	MOV	DWORD [4+ESI],EAX
   223 000001AC                                 L67:
   224 000001AC 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   225 000001AF 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   226 000001B3 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   227 000001B6 89 44 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EAX
   228 000001BA                                 L72:
   229 000001BA 31 C0                           	XOR	EAX,EAX
   230 000001BC                                 L43:
   231 000001BC 5B                              	POP	EBX
   232 000001BD 5E                              	POP	ESI
   233 000001BE 5F                              	POP	EDI
   234 000001BF 5D                              	POP	EBP
   235 000001C0 C3                              	RET
   236 000001C1                                 L61:
   237 000001C1 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   238 000001C4 FF 46 0C                        	INC	DWORD [12+ESI]
   239 000001C7 01 46 08                        	ADD	DWORD [8+ESI],EAX
   240 000001CA 83 C8 FF                        	OR	EAX,-1
   241 000001CD EB ED                           	JMP	L43
   242 000001CF                                 L74:
   243 000001CF 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   244 000001D2 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   245 000001D6 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   246 000001D9 01 44 DE 14                     	ADD	DWORD [20+ESI+EBX*8],EAX
   247 000001DD EB DB                           	JMP	L72
   248 000001DF                                 L73:
   249 000001DF 03 55 10                        	ADD	EDX,DWORD [16+EBP]
   250 000001E2 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   251 000001E6 3B 1E                           	CMP	EBX,DWORD [ESI]
   252 000001E8 7D D0                           	JGE	L72
   253 000001EA 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   254 000001ED 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   255 000001F0 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   256 000001F4 75 C4                           	JNE	L72
   257 000001F6 03 54 DE 14                     	ADD	EDX,DWORD [20+ESI+EBX*8]
   258 000001FA 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   259 000001FE 8B 06                           	MOV	EAX,DWORD [ESI]
   260 00000200 48                              	DEC	EAX
   261 00000201 89 06                           	MOV	DWORD [ESI],EAX
   262 00000203 39 C3                           	CMP	EBX,EAX
   263 00000205 7D B3                           	JGE	L72
   264 00000207 89 C1                           	MOV	ECX,EAX
   265 00000209                                 L58:
   266 00000209 8B 44 DE 18                     	MOV	EAX,DWORD [24+ESI+EBX*8]
   267 0000020D 8B 54 DE 1C                     	MOV	EDX,DWORD [28+ESI+EBX*8]
   268 00000211 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   269 00000215 89 54 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EDX
   270 00000219 43                              	INC	EBX
   271 0000021A 39 CB                           	CMP	EBX,ECX
   272 0000021C 7C EB                           	JL	L58
   273 0000021E EB 9A                           	JMP	L72
   274 00000220                                 	GLOBAL	_memman_alloc_4k
   275 00000220                                 _memman_alloc_4k:
   276 00000220 55                              	PUSH	EBP
   277 00000221 89 E5                           	MOV	EBP,ESP
   278 00000223 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   279 00000226 05 00000FFF                     	ADD	EAX,4095
   280 0000022B 25 FFFFF000                     	AND	EAX,-4096
   281 00000230 89 45 0C                        	MOV	DWORD [12+EBP],EAX
   282 00000233 5D                              	POP	EBP
   283 00000234 E9 FFFFFE9E                     	JMP	_memman_alloc
   284 00000239                                 	GLOBAL	_memman_free_4k
   285 00000239                                 _memman_free_4k:
   286 00000239 55                              	PUSH	EBP
   287 0000023A 89 E5                           	MOV	EBP,ESP
   288 0000023C 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   289 0000023F 05 00000FFF                     	ADD	EAX,4095
   290 00000244 25 FFFFF000                     	AND	EAX,-4096
   291 00000249 89 45 10                        	MOV	DWORD [16+EBP],EAX
   292 0000024C 5D                              	POP	EBP
   293 0000024D E9 FFFFFEE8                     	JMP	_memman_free
